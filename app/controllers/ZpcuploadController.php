<?php
session_start();
class ZpcuploadController extends BaseController{
	 
	public function index()
	{
			if (isset($_SESSION['mobile']) && !empty($_SESSION['mobile'])) {
				$mobile = $_SESSION['mobile'];
				$users = DB::table("users")->where(array("mobile"=>$mobile))->get();
				$worksa = DB::table("works")->where(array("user_id"=>$users[0]->id,"deleted_at"=>NULL))->get();
				$id = Input::get('id');
				$w = 0;
				if(!empty($id)){
					$worksas = DB::table("works")->where(array("id"=>$id,"user_id"=>$users[0]->id,"deleted_at"=>NULL))->get();
					$w = count($worksas);
				}
				// var_dump($worksas);
			if(strpos($_SERVER['HTTP_USER_AGENT'], 'MicroMessenger') == false ) {
			// $opus=DB::select("select id from works where deleted_at is NULL");
			// $rid=rand(0,(count($opus)-1));
			if($w>0){
				$play_id=$id;
			}else{
				$play_id=$worksa[0]->id;//echo $play_id;exit;
			}

			$works=json_decode($this->fgc($_ENV['HOST']."/api/work/".$play_id."/show"),1);
			//$peaks=json_decode(file_get_contents($works["links"]["waveform"]),1);//print_r($peaks);exit;
			
			foreach($works["data"]["persons"] as $key=>$val){
				switch ($val['key']) { 	
					case 0:
						$works["data"]["persons"][$key]["key"]="人声";
						break;
					case 1:
						$works["data"]["persons"][$key]["key"]="创作者";
						break;
					case 2:
						$works["data"]["persons"][$key]["key"]="图像";
						break;
					case 3:
						$works["data"]["persons"][$key]["key"]="吉他";
						break;
					case 4:
						$works["data"]["persons"][$key]["key"]="贝司";
						break;
					case 5:
						$works["data"]["persons"][$key]["key"]="鼓";
						break;
					case 6:
						$works["data"]["persons"][$key]["key"]="键盘";
						break;
					case 7:
						$works["data"]["persons"][$key]["key"]="管乐器";
						break;
					case 8:
						$works["data"]["persons"][$key]["key"]="弦乐器";
						break;
					case 9:
						$works["data"]["persons"][$key]["key"]="民族乐器";
						break;
					default:
						break;
				}
			}
			$comment=json_decode($this->fgc("http://123.57.1.143/api/comment/".$play_id."/show"),1);
			$tmpfile=json_decode($this->fgc("http://123.57.1.143/api/work/".$play_id."/tmpfile"),1);
			foreach($works["data"]["texts"] as $key => $item){
				$works["data"]["texts"][$key]["timeline"]=intval($item["timeline"]*$works["data"]["duration"]);
			}
			foreach($works["data"]["timeline"] as $key => $item){
				$works["data"]["timeline"][$key]=intval($item*$works["data"]["duration"]);
			}
			$duration=gmstrftime("%M'%S'",$works["data"]["duration"]);//var_dump($works);die;
			$peaks=json_decode(file_get_contents($works["links"]["waveform"]),1);
			
			return View::make('web/upload',[
				'mobile'=>$mobile,
				'users'=>$users,
				'worksa'=>$worksa,
				'works' => $works,
				'comment' => $comment,
				'tmpfile' => $tmpfile,
				'duration' => $duration,
				'play_id' => $play_id,
				'peaks' => $peaks,
			]);
		}


				// return View::make('web/home',['mobile'=>$mobile,'users'=>$users,'works'=>$works]);
			}else{
				return View::make('web/login');
			}
	}

	function fgc($url){
		$ch = curl_init();
		curl_setopt($ch, CURLOPT_URL, $url);
		curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
		curl_setopt($ch, CURLOPT_HEADER, 0);
		$output = curl_exec($ch);
		curl_close($ch);
		return $output;
	}

	public function ccomplate()
	{
		// var_dump($_POST);
		$mobile = $_SESSION['mobile'];
		$users = DB::table("users")->where(array("mobile"=>$mobile))->get();
		$username = $users[0]->username;
		$user_id = $users[0]->id;
		$title = $_POST['title'];
		$cover = $_POST['picurl'][$_POST['fengm']];
		$waveform = $_POST['waveform'];
		$duration = $_POST['totalTime'];
		$playurl = $_POST['playurl'];
		//user_id,username,title,is_dmshow,cover,waveform,duration,filesize,playurl,
		//texts,persons,filename,etag,mime,is_private,s_verify,is_recommend,is_contshow
		//is_compshow,is_compshowtype,type_id,pricetype,s_musician
		//compstatus,view_count,love_count,play_count,modified,created_at,updated_at
		  $pathinfo=pathinfo($_ENV['QINIUHOST'].$playurl);
		 // $playurl=explode("/",$playurl);
		 $work = new Work();
		 $work->user_id=$user_id;
		 $work->username=$username;
		 $work->title=$title;
		 $work->waveform=$waveform;
		 $work->cover=$cover;
		 $work->playurl=$playurl;
		 $work->is_dmshow=0;
		 $work->is_compshow=0;
		 // $work->comptime=$_POST["comptime"];
		 $work->type_id=0;
		 // $work->price=$_POST["price"];
		 $work->pricetype=0; 
		 $work->compstatus=0; 
		 $work->is_recommend=0;
		 // $work->reason=$_POST["reason"];
		 $work->is_private=1;
		 $work->is_verify=0;
		 $work->love_count=0;
		 $work->play_count=0;
		 $work->modified=date("Y-m-d H:i:s",time());
		 $work->duration=intval($duration);
		 // if($_POST["is_recommend"]==1){
			//  $work->recommendtime=date("Y-m-d H:i:s",time());
		 // }
		 $persons = array();
		 // if($_POST["persons"]!="")
		 // {
			//  $arr_p = explode(";",$_POST["persons"]);
			//  foreach($arr_p as $key=>$item)
			//  {
			// 	 $itemEx=explode(":",$item);
			// 	 $persons[$key]["key"]=intval($itemEx[0]);
			// 	 $persons[$key]["name"]=$itemEx[1];
			// 	 unset($itemEx);
			//  }
			// }

   
		 $work->persons=serialize($persons);
		 $newPlayurl=explode("/", $playurl);
		 $work->filename=$newPlayurl[count($newPlayurl)-1];

		 $work->etag=0;
		 $work->mime=$pathinfo["extension"];
	     $mediaInfo=json_decode(file_get_contents($_ENV['QINIUHOST'].$_POST["playurl"]."?avinfo"));
		//  $work->duration=intval($mediaInfo->format->duration);
		 $work->filesize=$mediaInfo->format->size;
		 $texts = array();

		 //print_r($_POST);die;
		 if($_POST["jj_words"]!="")
		 {
			 // $arr_t = explode(";",$_POST["texts"]);
			 foreach($_POST["jj_words"] as $key=>$item)
			 {
				 // $itemEx=explode(":",$item);
				 $texts[$key]["content"]=$item;
				 $texts[$key]["timeline"]=$_POST["jj_wtime"][$key]/$work->duration;
				 // unset($itemEx);
			 }
			}
				// echo "<br><br>";
			$work->texts=serialize($texts);
		// 	echo "<br><br>";
			//print_r($work);die;
			$work->save();
		// 	DB::update('update users set works_count = works_count+1 where id = ?', array($_POST["user_id"]));
		//  if($_POST["tag"]!="")
		//  {
		// 	 $tags=explode(",",$_POST["tag"]);
		// 	 foreach($tags as $key=>$item)
		// 	 {
		// 		 if($item!="")
		// 		 {
		// 			 $tag=new Tag();
		// 			 if(!$tag->where("name",$item)->first()){
		// 				$tag->user_id = $_POST["user_id"];
		// 				$tag->name = $item;
		// 				$tag->save();
		// 				DB::table("works_tags")->insert(array("work_id"=>$work->id,"tag_id"=>$tag->id));
		// 				DB::update('update tags set count = count+1 where id = ?', array($tag->id));
		// 			 }else{
		// 				$isset = $tag->where("name",$item)->first();
		// 				DB::table("works_tags")->insert(array("work_id"=>$work->id,"tag_id"=>$isset->id));
		// 				DB::update('update tags set count = count+1 where id = ?', array($isset->id));
		// 			 }
					 
		// 		 }
		// 	 }
		// 	}



		 foreach($_POST["picurl"] as $key => $item)
		 {
			  $iteminfo=json_decode(file_get_contents($_ENV['QINIUHOST'].$item."?avinfo"));
			  //print_r($iteminfo);die;
			  //print_r($item);die;
			  

		 	  
			  
			  $workimage=new Workimage();
			  $workimage->work_id=$work->id;
			 // $workimage->work_id=7072;
			  $workimage->orderby=($key+1)*10;
			 // $workimage->etag=$_POST["hash"][$key];
			  $workimage->url=$item;
			  $workimage->width=0;
			  $workimage->height=0;
			  $newPicurl=explode("/", $item);
			  $workimage->filename=$newPicurl[count($newPicurl)-1];
			  $workimage->filesize=$iteminfo->format->size;;
			  $workimage->timeline=$_POST["fengm"][$key];
			  $workimage->etag=0;
			  $workimage->mime=$iteminfo->format->format_name;
			  //print_r($workimage);die;
			 $workimage->save();
		 }
		//  Queue::push('Capsule\Core\Task@handleFetchPeaks', array('id' => $work->id));
		 return Redirect::to('http://pillele.cn/home');
		
	}	

	public function waveform()
	{
		$a = '[0.00006103515625,0.00006103515625,0.00006103515625,0.00006103701889515,0.00009155552834272,0.00006103701889515,0.000091552734375,0.000091552734375,0.201629638671875,0.16971343755722046,0.16306039690971375,0.24130985140800476,0.202606201171875,0.42364501953125,0.3876461088657379,0.4832911193370819,0.2225409746170044,0.29569384455680847,0.523956298828125,0.1268349289894104,0.200653076171875,0.35821533203125,0.30451369285583496,0.4981689453125,0.32354736328125,0.31238746643066406,0.4879150390625,0.37606811523437506,0.22406005859375,0.196136474609375,0.576080322265625,0.42252877354621887,0.4180908203125,0.304229736328125,0.28000733256340027,0.26483154296875,0.188970610499382,0.286873996257782,0.2921536862850189,0.345489501953125,0.3236792981624603,0.2931302785873413,0.63665771484375,0.4620197117328644,0.52110356092453,0.46505737304687506,0.349365234375,0.5263671875,0.503402829170227,0.6211127042770386,0.511627197265625,0.39661854505538946,0.6613056063652039,0.40097045898437506,0.49642944335937506,0.5100253224372864,0.40800195932388306,0.39950561523437506,0.3729361891746521,0.35401469469070435,0.58544921875,0.7366862893104553,0.48042237758636475,0.3560594618320465,0.9609973430633546,0.66204833984375,0.6741943359375,0.40183719992637634,0.35923337936401367,0.4042176604270935,0.51129150390625,0.47636342048645014,0.35398417711257935,0.62359619140625,0.5836054682731628,0.5336771607398987,0.2862548828125,0.68731689453125,0.543609619140625,0.5148472785949707,0.5316629409790039,0.42512282729148865,0.43978881835937506,0.3801385462284088,0.43937498331069946,0.637603759765625,0.581939697265625,0.4503616392612458,0.46075439453125,0.490951269865036,0.45616015791893005,0.585662841796875,0.38958740234375,0.43408203125,0.6512649655342102,0.6412854194641113,0.6130253076553345,0.4486220777034759,0.617462158203125,0.7669677734375,0.39956665039062494,0.40377807617187506,0.38232421875,0.57232666015625,0.39700317382812494,0.500885009765625,0.524078369140625,0.8915405273437501,0.5185546875,0.8377330899238588,0.20654296875,0.5658742189407349,0.49554443359375,0.5061189532279968,0.738128662109375,0.599719226360321,0.739410400390625,0.599395751953125,0.5984679460525513,0.923370361328125,0.692047119140625,0.636016845703125,0.964293360710144,0.71197509765625,0.61126708984375,0.5320596694946289,0.852259874343872,0.8140202164649963,0.709197998046875,0.784637451171875,0.7801141142845154,0.789215087890625,0.789154052734375,0.7467651367187501,0.8311157226562499,0.845458984375,0.542572021484375,0.6777245402336121,0.8470412492752075,0.7013458609580994,0.6244697570800781,0.558990478515625,0.65673828125,0.56353759765625,0.7596362233161926,0.569000244140625,0.5926513671875,0.60650634765625,0.551727294921875,0.5593737363815308,0.8033447265625,0.7495040893554688,0.8028564453125,0.674468994140625,0.7608569860458374,0.9179052114486694,0.5804010033607483,0.777099609375,0.6416211128234863,0.7860347032546997,0.8183538317680359,0.930023193359375,0.5307474136352539,0.7215185761451721,0.730621337890625,0.6230964064598083,0.8068178296089172,0.608367919921875,0.68609619140625,0.90966796875,0.6904813051223755,0.46176147460937506,0.5524460673332214,0.527557373046875,0.870269775390625,0.47563096880912786,0.545074462890625,0.778961181640625,0.7246925234794616,0.5556504726409912,0.7711181640625,0.621124267578125,0.86993008852005,0.40281379222869873,0.966217041015625,0.614654541015625,0.5912961363792419,0.657196044921875,0.5933837890625,0.627838134765625,0.6597186326980591,0.4218573570251465,0.7423932552337646,0.52545166015625,0.9172948598861694,0.8660542368888854,0.61029052734375,0.511260986328125,0.43531602621078486,0.7331766486167908,0.35357666015625,0.7862483859062195,0.59661865234375,0.8110961914062499,0.593017578125,0.9032868146896361,0.3768425583839417,0.4358958601951599,0.4036683142185211,0.46771240234375,0.8959929347038269,0.6014587879180908,0.851898193359375,0.6746421456336975,0.590545654296875,0.8341674804687501,0.6334726810455322,0.764824390411377,0.825439453125,0.7680287957191467,0.67095947265625,0.5480819344520569,0.7869197726249695,0.6847743391990662,0.6285287141799927,0.7928466796875,0.47750854492187506,0.616779088973999,0.4984282851219178,0.745849609375,0.5771484375,0.9368896484375,0.738555908203125,0.41824340820312494,0.41731008887290955,0.9636829495429992,0.51922607421875,0.8373973965644836,0.5274208784103394,0.6431470513343811,0.7779541015625,0.852142333984375,0.767120361328125,0.4538102447986602,0.8301034569740297,0.395672470331192,0.784423828125,0.52587890625,0.8476821184158325,0.61309814453125,0.70166015625,0.5335245728492737,0.7691040039062499,0.4711752533912658,0.7799615263938904,0.729697585105896,0.461669921875,0.590850830078125,0.5478377342224121,0.634418785572052,0.513946533203125,0.651092529296875,0.41830444335937506,0.617725133895874,0.5247047543525696,0.6226806640625,0.8220160603523254,0.713348388671875,0.860809326171875,0.6416516900062561,0.9547729492187501,0.5290688872337341,0.713217556476593,0.7682119011878968,0.946990966796875,0.3985595703125,0.50732421875,0.5203857421875,0.5322265625,0.5831298828125,0.3570556640625,0.5821533203125,0.770233154296875,0.7037353515625,0.7234497070312499,0.952178955078125,0.9500411748886108,0.5085299015045166,0.5963926911354065,0.9054841995239258,0.49642944335937506,0.8157292604446411,0.53753662109375,0.532745361328125,0.616668701171875,0.8535766601562499,0.537109375,0.8178350329399109,0.49090576171875,0.571014404296875,0.576507568359375,0.54608154296875,0.47379985451698303,0.564971923828125,0.712188720703125,0.7083041071891785,0.9614551067352295,0.9436323046684265,0.886013388633728,0.8802148699760437,0.9091463685035706,0.59063720703125,0.7870723605155946,0.7226477861404419,0.7383953332901002,0.9200720191001893,0.7793579101562499,0.815887451171875,0.8369395732879639,0.7627796530723571,0.784423828125,0.9482100605964661,0.823822021484375,0.5960264801979065,0.4880214929580689,0.795867919921875,0.781463623046875,0.811309814453125,0.9319742321968079,0.66485595703125,0.6494033336639404,0.7333292365074159,0.7659912109375,0.71160888671875,0.6226691603660583,0.966339111328125,0.5594958066940308,0.8910489082336426,0.721610128879547,0.7374187707901002,0.751129150390625,0.7438354492187501,0.8129825592041016,0.6644287109375,0.6642048358917236,0.5541856288909912,0.9298684597015381,0.7051301598548889,0.591705322265625,0.8407849073410033,0.707489013671875,0.811004638671875,0.724151611328125,0.5827814340591431,0.7566453814506531,0.7767333984375,0.761260986328125,0.61248779296875,0.972930073738098,0.833465576171875,0.657318115234375,0.8812524676322938,0.8070009350776672,0.7934201955795288,0.4929044544696808,0.5719168782234192,0.50439453125,0.6193121075630188,0.782989501953125,0.6711325645446777,0.49922177195549006,0.8645588755607605,0.7361674904823304,0.7909545898437501,0.8901333808898927,0.7991333007812499,0.8376110196113588,0.7327880859375,0.5586718320846558,0.6313669085502625,0.7721182703971863,0.7705007791519165,0.9162266850471495,0.9244995117187501,0.578521728515625,0.761444091796875,0.818572998046875,0.6315805315971375,0.766632080078125,0.9339579343795776,0.6295166015625,0.6922818422317505,0.732421875,0.8911709785461426,0.8218939900398254,0.7499008178710938,0.7347025871276855,0.6930448412895203,0.8064575195312499,0.9500732421875,0.695159912109375,0.536865234375,0.8972136378288269,0.8067567944526672,0.792877197265625,0.8724936842918395,0.9178136587142944,0.885650634765625,0.8029174804687501,0.8235473632812499,0.590179443359375,0.6337890625,0.8029174804687501,0.8606525063514708,0.808099627494812,0.788970947265625,0.69122314453125,0.870697021484375,0.673583984375,0.814117431640625,0.861232340335846,0.835662841796875,0.95706045627594,0.7892086505889893,0.718658447265625,0.8153019547462464,0.749053955078125,0.870941162109375,0.845977783203125,0.7608264684677125,0.7590942382812499,0.9476318359375,0.605926513671875,0.952392578125,0.7350077629089355,0.614410400390625,0.7733764648437501,0.671295166015625,0.774169921875,0.5794244408607483,0.8330688476562499,0.7374187707901002,0.8289437294006348,0.6326904296875,0.838714599609375,0.946685791015625,0.7180700302124023,0.7979369759559632,0.7246620059013367,0.7156285047531128,0.69293212890625,0.8952299356460571,0.7893002033233644,0.768402099609375,0.587188720703125,0.617511510848999,0.7159337401390076,0.6982421875,0.58514404296875,0.9703979492187501,0.5652638077735901,0.884063720703125,0.7394940257072448,0.7308349609375,0.714599609375,0.921844482421875,0.8557739257812499,0.6873989105224609,0.8414306640625,0.873046875,0.8753013610839844,0.683868408203125,0.5227210521697998,0.690521240234375,0.6282235383987427,0.7490463256835938,0.706146240234375,0.791955292224884,0.8866577148437501,0.60028076171875,0.7638172507286072,0.6792199611663818,0.9541015625,0.543212890625,0.6313669085502625,0.907257080078125,0.945281982421875,0.6386913657188416,0.7101962566375732,0.8015747070312499,0.644866943359375,0.9353312849998474,0.8344065546989442,0.7260131835937501,0.8388061523437501,0.7503890991210938,0.819671630859375,0.5874508023262024,0.8193303942680359,0.8102664351463318,0.9604175090789795,0.63543701171875,0.825617253780365,0.935821533203125,0.711151123046875,0.9695119857788086,0.8344981074333191,0.594970703125,0.8923917412757874,0.969757080078125,0.6207159757614136,0.71319580078125,0.5992431640625,0.46345409750938416,0.7611011266708374,0.784271240234375,0.9573364257812499,0.962799072265625,0.6073793768882751,0.6905118227005005,0.8531494140625,0.7622302770614624,0.867919921875,0.6982329487800598,0.6499832272529602,0.6616107821464539,0.833404541015625,0.595794677734375,0.669586181640625,0.9080477356910706,0.6148869395256042,0.8479262590408325,0.4427320063114166,0.6186712384223938,0.46694946289062494,0.6640827655792236,0.580718994140625,0.877899169921875,0.6798913478851318,0.52079838514328,0.5619983673095703,0.721488058567047,0.719207763671875,0.853057861328125,0.748779296875,0.634765625,0.6678365468978882,0.8282113075256348,0.9692068099975586,0.42776489257812494,0.7025971412658691,0.6537370085716248,0.773003339767456,0.511016845703125,0.7745292782783508,0.51251220703125,0.7619018554687501,0.5277099609375,0.7747123837471008,0.71697998046875,0.6730552315711975,0.7781914472579957,0.8955045938491821,0.725982666015625,0.50750732421875,0.46270751953125,0.8443861007690431,0.5458235144615173,0.70458984375,0.7648315429687501,0.63250732421875,0.686676025390625,0.6069521307945251,0.56964111328125,0.9078341126441956,0.9281005859375,0.583038330078125,0.878814697265625,0.8858642578125,0.9727469682693481,0.841339111328125,0.9727172851562499,0.7125244140625,0.8141117691993713,0.8141728043556212,0.55078125,0.641326904296875,0.64398193359375,0.7587816715240479,0.6236762404441833,0.859344482421875,0.7981505990028381,0.6626483798027039,0.6864528059959412,0.935211181640625,0.8740844726562499,0.830596923828125,0.787841796875,0.647216796875,0.7694326639175414,0.756004512310028,0.9676513671875,0.9515380859375,0.908782958984375,0.694000244140625,0.8761596679687501,0.5653076171875,0.7314453125,0.9503464102745056,0.712188720703125,0.4776451885700226,0.844940185546875,0.9502853751182557,0.6898403763771057,0.586883544921875,0.8372753262519836,0.902435302734375,0.5903805494308472,0.9557495117187501,0.5776543617248535,0.6585693359375,0.9742431640625,0.9420148134231568,0.8033387064933778,0.871978759765625,0.595001220703125,0.9569702148437501,0.887725830078125,0.912017822265625,0.964202880859375,0.5581530332565308,0.6887417435646057,0.670379638671875,0.573564887046814,0.54632568359375,0.8452101349830627,0.6463515162467957,0.8460646271705627,0.9044189453125,0.782928466796875,0.5757316946983337,0.6226386427879333,0.8734092116355896,0.9852294921875,0.4942167401313782,0.837432861328125,0.8102359175682067,0.5787353515625,0.6421094536781311,0.973876953125,0.64276123046875,0.7996154427528381,0.854095458984375,0.7701345682144165,0.6726279258728027,0.627532958984375,0.7825317382812499,0.843440055847168,0.9710074067115784,0.9432050585746765,0.659515380859375,0.9235206246376036,0.888702392578125,0.940826416015625,0.901336669921875,0.8340098261833191,0.7619556188583374,0.8059023022651672,0.9605395793914795,0.756195068359375,0.7590869069099425,0.8347422480583191,0.6664326786994934,0.861110270023346,0.709381103515625,0.510498046875,0.6805932521820068,0.537628173828125,0.6100039482116699,0.622955322265625,0.7856684923171997,0.5315103530883789,0.742034912109375,0.630523681640625,0.8450880646705627,0.525970458984375,0.907440185546875,0.8350474834442139,0.7818536758422852,0.7517700195312499,0.945953369140625,0.8060854077339172,0.8552201986312865,0.69146728515625,0.8996856808662415,0.671722412109375,0.775543212890625,0.781982421875,0.9479354023933412,0.9356974959373474,0.8939787149429321,0.9197668433189392,0.965391993522644,0.97607421875,0.7495346069335938,0.9589220881462097,0.71893310546875,0.715850830078125,0.699981689453125,0.48403930664062494,0.8968779444694518,0.6839808225631714,0.928375244140625,0.8174438476562499,0.7263710498809814,0.5920590758323669,0.911773681640625,0.9845581054687501,0.739288330078125,0.635101318359375,0.78313547372818,0.7816162109375,0.856903076171875,0.6616412997245789,0.637115478515625,0.8035523295402527,0.7207861542701721,0.741973876953125,0.732696533203125,0.6138797998428345,0.9666137695312499,0.8039491176605223,0.8662374019622803,0.6934814453125,0.44821166992187506,0.599566638469696,0.7338480949401855,0.7838745117187501,0.792999267578125,0.8424072265625,0.6859034895896912,0.667022705078125,0.662750244140625,0.57025146484375,0.7578051090240479,0.745452880859375,0.839141845703125,0.6678670644760132,0.7749260067939758,0.7489624023437501,0.922088623046875,0.6541748046875,0.8123416900634767,0.9058504104614258,0.8529663085937501,0.7634205222129823,0.69281005859375,0.8049867153167725,0.842860221862793,0.9293496608734131,0.7157810926437378,0.8207647800445557,0.7999267578125,0.7876521944999695,0.6256904602050781,0.7441328167915344,0.8145695328712464,0.7773979902267456,0.8825953006744384,0.629364013671875,0.7354350686073304,0.7408978343009949,0.9594714045524597,0.9028595685958862,0.8482009172439574,0.9285278320312499,0.9491256475448608,0.9557481408119202,0.8317209482192993,0.712738037109375,0.6678670644760132,0.8372192382812499,0.9188207387924193,0.809112548828125,0.635181725025177,0.9346598982810974,0.8666951656341552,0.95754873752594,0.6323740482330322,0.6337168216705322,0.54351806640625,0.6258125305175781,0.742034912109375,0.9400634765625,0.632965087890625,0.723227620124817,0.71661376953125,0.9878231287002563,0.7976927757263184,0.8979766368865967,0.837188720703125,0.9718924760818481,0.7940063476562499,0.6161381602287292,0.7549058198928834,0.9636829495429992,0.91162109375,0.877349853515625,0.9706420898437501,0.8709982633590697,0.95068359375,0.862152099609375,0.773918867111206,0.7273476123809814,0.9138767719268799,0.7528076171875,0.5837580561637878,0.8785668611526489,0.8086547851562499,0.9287698268890381,0.657867431640625,0.9704886078834535,0.46804809570312494,0.6964018940925598,0.7871639132499695,0.8174688220024109,0.917449951171875,0.9319437146186829,0.8792992830276489,0.84423828125,0.9367961883544922,0.618927001953125,0.7338256835937501,0.45533615350723267,0.753021240234375,0.893951416015625,0.935699462890625,0.6358531713485718,0.6029542088508606,0.6422119140625,0.62152099609375,0.9618530273437501,0.958404541015625,0.727935791015625,0.6658833622932434,0.759307861328125,0.8040406703948975,0.7888424396514893,0.6845606565475464,0.534820556640625,0.752655029296875,0.736175537109375,0.748069703578949,0.752410888671875,0.8988921642303467,0.9230323433876036,0.9389324784278871,0.9409790039062499,0.919677734375,0.5197607278823853,0.8896450400352478,0.9233680367469788,0.842951774597168,0.6998809576034546,0.7564012408256531,0.7452925443649291,0.7657399177551268,0.6673787832260132,0.9698172211647034,0.8193359375,0.8062074780464172,0.4362926185131073,0.65814208984375,0.8350474834442139,0.525054931640625,0.9090242981910706,0.642120361328125,0.7536545991897582,0.855560302734375,0.5946044921875,0.784820556640625,0.8641357421875,0.8442993164062499,0.701019287109375,0.7620849609375,0.53729248046875,0.8765869140625,0.4979705214500427,0.8134708404541016,0.8335215449333191,0.8697509765625,0.9802240133285524,0.830780029296875,0.886138916015625,0.8488418459892274,0.67730712890625,0.7206946015357971,0.6326792240142822,0.6877956390380859,0.7574388980865479,0.8755455017089844,0.8001098632812499,0.7550889849662781,0.8062074780464172,0.57977294921875,0.587799072265625,0.728057861328125,0.876308500766754,0.8281197547912599,0.904110848903656,0.7564622759819031,0.7931455373764038,0.9355143904685974,0.754638671875,0.807769775390625,0.876800537109375,0.56146240234375,0.577880859375,0.7218238115310669,0.6985381841659546,0.767059326171875,0.6821802258491516,0.5503402948379517,0.413818359375,0.885894775390625,0.698028564453125,0.5378276705741882,0.8727073073387146,0.808380126953125,0.911956787109375,0.8205206394195557,0.644317626953125,0.4820556640625,0.730377197265625,0.8895263671875,0.714324951171875,0.5494247078895569,0.6898708939552307,0.842860221862793,0.843841552734375,0.652801513671875,0.9219336509704591,0.5226905345916748,0.4447021484375,0.6686605215072632,0.6299630999565125,0.7827997803688049,0.6292306184768677,0.567596435546875,0.7374877929687501,0.9167149662971495,0.764617919921875,0.8626056909561157,0.7500228881835938,0.6766868829727173,0.930936634540558,0.5900448560714722,0.646942138671875,0.665557861328125,0.788787841796875,0.618011474609375,0.5633544921875,0.6866455078125,0.6212042570114136,0.6177978515625,0.6777245402336121,0.7821588516235352,0.741668701171875,0.7010712027549744,0.7193517684936523,0.7640380859375,0.7363505959510803,0.5504150390625,0.6196478009223938,0.787933349609375,0.6873779296875,0.731109619140625,0.69525146484375,0.9446699619293213,0.7381591796875,0.8294320702552795,0.7423322200775148,0.7578356266021729,0.8734741210937501,0.8099307417869568,0.748557984828949,0.9550157189369202,0.9034394621849061,0.813079833984375,0.6232489943504333,0.898193359375,0.9391479492187501,0.7339091300964355,0.670796811580658,0.6222419142723083,0.9274880290031433,0.8815307617187501,0.886810302734375,0.8007751703262329,0.6478469371795654,0.874969482421875,0.712607204914093,0.746368408203125,0.692901611328125,0.8597369194030762,0.6106143593788147,0.6451612710952759,0.6542252898216248,0.4502090513706207,0.3565172255039215,0.17920468747615814,0.3438720703125,0.3814813792705536,0.339019775390625,0.274688720703125,0.208709716796875,0.1463623046875,0.08615375310182571,0.050537109375,0.02786339819431305,0.00787353515625,0.00326548051089048,0.00103759765625,0.00042725913226604]';
		$a2 = json_decode($a);
		foreach($a2 as $k => $v){
			$b[] = $v*100;
		}
		echo json_encode($b);
		// echo $b = '{"peaks":'.$a.'}';
		$waveall = count(json_decode($a));
		
		$wavereal = 1500;
		// echo $waveall;
		
	}	

	
}